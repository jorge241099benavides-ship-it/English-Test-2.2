<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English Exam A1</title>

<style>
* {
  box-sizing: border-box;
  -webkit-user-select: none;
  user-select: none;
}

body {
  font-family: "Segoe UI", Roboto, Arial, sans-serif;
  background: linear-gradient(135deg, #e9efff, #f7f9fc);
  margin: 0;
  padding: 20px;
  color: #222;
}

.container {
  max-width: 900px;
  margin: auto;
  background: #ffffff;
  padding: 28px;
  border-radius: 14px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.12);
}

h1 {
  text-align: center;
  color: #1f3c88;
}

.instructions {
  text-align: center;
  background: #f0f4ff;
  padding: 14px;
  border-radius: 8px;
  margin-bottom: 25px;
  font-size: 15px;
}

.student-info {
  margin-bottom: 25px;
}

.student-info label {
  font-weight: bold;
}

.student-info input {
  width: 100%;
  padding: 10px;
  font-size: 16px;
  border-radius: 8px;
  border: 1px solid #ccd4ea;
}

.section {
  margin-top: 30px;
  padding: 20px;
  border-radius: 10px;
  background: #fafbff;
  border-left: 6px solid #1f3c88;
}

.section h2 {
  margin-top: 0;
  color: #1f3c88;
}

.question {
  margin-bottom: 18px;
}

.question p {
  margin: 0 0 6px 0;
  font-weight: 500;
}

select {
  width: 100%;
  padding: 10px;
  font-size: 16px;
  border-radius: 8px;
  border: 1px solid #ccd4ea;
}

button {
  width: 100%;
  margin-top: 30px;
  padding: 16px;
  font-size: 18px;
  background: linear-gradient(135deg, #1f3c88, #3456c7);
  color: white;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  font-weight: bold;
}

button:hover {
  opacity: 0.95;
}

#finishBtn {
  background: #c62828;
  margin-top: 20px;
}

.result {
  display: none;
  margin-top: 35px;
  padding: 25px;
  background: #eef2ff;
  border-radius: 12px;
}

.correct { color: #1a7f37; font-weight: bold; }
.incorrect { color: #c62828; font-weight: bold; }
</style>
</head>

<body
oncopy="return false"
onpaste="return false"
oncut="return false"
oncontextmenu="return false">

<div class="container">

<h1>English Exam â€“ 1st Level (A1)</h1>

<div class="instructions">
<strong>Instructions:</strong><br>
Write your full name. Read carefully and select the correct answer.<br>
You can only see your score after finishing the exam.
</div>

<div class="student-info">
<label>Student Name</label>
<input type="text" id="studentName" placeholder="Write your full name">
</div>

<form id="exam">

<div class="section">
<h2>Exam Questions</h2>

<div class="question"><p>1. I like ___ soccer.</p>
<select name="q1"><option value="">Select</option><option>playing</option><option>play</option></select></div>

<div class="question"><p>2. I donâ€™t like ___ TV at night.</p>
<select name="q2"><option value="">Select</option><option>watching</option><option>watch</option></select></div>

<div class="question"><p>3. She likes ___ to music.</p>
<select name="q3"><option value="">Select</option><option>listening</option><option>listen</option></select></div>

<div class="question"><p>4. In my opinion, soccer is ___.</p>
<select name="q4"><option value="">Select</option><option>fun</option><option>in</option></select></div>

<div class="question"><p>5. I enjoy ___ at home.</p>
<select name="q5"><option value="">Select</option><option>cooking</option><option>cook</option></select></div>

<div class="question"><p>6. ___ a sofa in the living room.</p>
<select name="q6"><option value="">Select</option><option>There is</option><option>There are</option></select></div>

<div class="question"><p>7. ___ a TV in the living room.</p>
<select name="q7"><option value="">Select</option><option>There is</option><option>There are</option></select></div>

<div class="question"><p>8. ___ two chairs next to the table.</p>
<select name="q8"><option value="">Select</option><option>There is</option><option>There are</option></select></div>

<div class="question"><p>9. The TV is ___ the sofa.</p>
<select name="q9"><option value="">Select</option><option>in front of</option><option>under</option></select></div>

<div class="question"><p>10. The table is ___ the living room.</p>
<select name="q10"><option value="">Select</option><option>in</option><option>on</option></select></div>

<div class="question"><p>11. You sleep in the ___.</p>
<select name="q11"><option value="">Select</option><option>bedroom</option><option>kitchen</option></select></div>

<div class="question"><p>12. A refrigerator is in the ___.</p>
<select name="q12"><option value="">Select</option><option>kitchen</option><option>bathroom</option></select></div>

<div class="question"><p>13. A sofa is in the ___.</p>
<select name="q13"><option value="">Select</option><option>living room</option><option>bedroom</option></select></div>

<div class="question"><p>14. There is a ___ in the bedroom.</p>
<select name="q14"><option value="">Select</option><option>bed</option><option>chairs</option></select></div>

<div class="question"><p>15. There are ___ in the kitchen.</p>
<select name="q15"><option value="">Select</option><option>chairs</option><option>bed</option></select></div>

</div>

<button type="button" onclick="gradeExam()">Submit Exam</button>
</form>

<div class="result" id="result"></div>
<button id="finishBtn" style="display:none;" onclick="finishExam()">Finish</button>

</div>

<script>
/* ðŸ”´ PEGA AQUÃ TU URL DEL APPS SCRIPT */
const SHEET_URL = "https://script.google.com/macros/s/AKfycbwS-6ypOv_qEQiwTrTg95V1erpr6Egn-vMMcHEF80uX2yNUu3vp0ookTKDrAWUKP95-/exec";

const answers = {
q1:"playing", q2:"watching", q3:"listening", q4:"fun", q5:"cooking",
q6:"There is", q7:"There is", q8:"There are",
q9:"in front of", q10:"in",
q11:"bedroom", q12:"kitchen", q13:"living room",
q14:"bed", q15:"chairs"
};

function sendToSheets(name, score) {
  const payload = {
    name: name,
    score: Math.round(score)
  };

  Object.keys(answers).forEach(q => {
    payload[q] = document.querySelector(`[name=${q}]`).value;
  });

  fetch(SHEET_URL, {
    method: "POST",
    body: JSON.stringify(payload),
    headers: { "Content-Type": "application/json" }
  });
}

function gradeExam(){
  const name = document.getElementById("studentName").value.trim();
  if(name === ""){
    alert("Please write your name before submitting the exam.");
    return;
  }

  let score = 0;
  let feedback = `<h2>Student: ${name}</h2>`;

  for(let q in answers){
    let user = document.querySelector(`[name=${q}]`).value;
    if(user === answers[q]){
      score += 100/15;
      feedback += `<p>${q}: <span class="correct">Correct</span></p>`;
    } else {
      feedback += `<p>${q}: <span class="incorrect">Incorrect</span> (Correct: ${answers[q]})</p>`;
    }
  }

  sendToSheets(name, score);

  document.getElementById("result").innerHTML =
    `<h2>Final Score: ${Math.round(score)} / 100</h2>` + feedback;

  document.getElementById("result").style.display = "block";
  document.getElementById("finishBtn").style.display = "block";
  window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
}

function finishExam(){
  document.body.innerHTML = `
  <div style="display:flex;align-items:center;justify-content:center;height:100vh;text-align:center;font-family:Segoe UI,Arial;background:#f4f6f9;">
    <div>
      <h1>Exam Finished</h1>
      <p>Please send a screenshot of your score.</p>
      <p>You may now close this page.</p>
    </div>
  </div>`;
  setTimeout(() => { window.close(); }, 800);
}
</script>

</body>
</html>

